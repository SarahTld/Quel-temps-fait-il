import{r as b,g as y,j as _,c as d,a as r,l as f,C as E,p as $,v as C,t as a,F as M,y as D,o as u}from"./DuGDK2SR.js";import{u as j}from"./aARV7R7-.js";const F={class:"flex flex-col items-center py-10 px-4"},P={class:"w-full max-w-4xl"},V={class:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-2xl p-6 mb-8 shadow-lg border border-white/40 dark:border-gray-700/40"},L={key:0,class:"bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-6 text-center"},U={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4"},I={class:"flex flex-col items-center text-center"},R={class:"text-lg font-semibold text-blue-800 dark:text-blue-100 mb-2"},S=["src","alt"],z={class:"text-sm text-blue-600 dark:text-blue-300 capitalize mb-2"},A={class:"text-2xl font-bold text-blue-800 dark:text-blue-100 mb-1"},B={class:"text-xs text-blue-500 dark:text-blue-300 mb-3"},K={class:"text-xs text-blue-600 dark:text-blue-300 space-y-1"},N={key:2,class:"text-center text-blue-600 dark:text-blue-300"},h="https://api.openweathermap.org/data/2.5/forecast",W={__name:"previsions",setup(T){const c=b(""),l=b(null),o=b(""),g=y().public.openweatherKey,{getApiUnits:m,formatTemperature:p,formatWindSpeed:w}=j();_(()=>{window.addEventListener("units-changed",()=>{l.value&&x()})});async function x(){if(o.value="",!!c.value)try{const s=`${h}?q=${encodeURIComponent(c.value)}&appid=${g}&units=${m()}&lang=fr`,t=await fetch(s);if(!t.ok){const n=await t.json();throw new Error(n.message||"Ville non trouvée")}const e=await t.json();v(e)}catch(s){l.value=null,o.value=s.message||"Erreur lors de la récupération des prévisions."}}function v(s){const t={};s.list.forEach(e=>{const i=new Date(e.dt*1e3).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"});t[i]||(t[i]={date:i,temp:p(e.main.temp),tempMin:p(e.main.temp_min),tempMax:p(e.main.temp_max),humidity:e.main.humidity,wind:w(e.wind.speed),description:e.weather[0].description,icon:`https://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`})}),l.value=Object.values(t).slice(0,5)}function k(){o.value="",navigator.geolocation&&navigator.geolocation.getCurrentPosition(async s=>{try{const{latitude:t,longitude:e}=s.coords,n=await fetch(`${h}?lat=${t}&lon=${e}&appid=${g}&units=${m()}&lang=fr`);if(!n.ok)throw new Error("Ville non trouvée");const i=await n.json();c.value=i.city.name,v(i)}catch(t){l.value=null,o.value=t.message||"Erreur lors de la récupération des prévisions."}},()=>{o.value="Impossible d'obtenir la position."})}return(s,t)=>(u(),d("div",F,[r("div",P,[t[3]||(t[3]=r("h1",{class:"text-3xl font-bold text-blue-700 dark:text-blue-200 mb-8 text-center"},"Prévisions sur 5 jours",-1)),r("div",V,[r("form",{class:"flex gap-3",onSubmit:E(x,["prevent"])},[$(r("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),type:"text",placeholder:"Entrez une ville pour les prévisions...",class:"flex-1 px-4 py-3 rounded-full border border-blue-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-400 dark:focus:ring-blue-500 bg-white/70 dark:bg-gray-700/70 placeholder:text-blue-300 dark:placeholder:text-gray-400 text-blue-900 dark:text-gray-100 font-medium"},null,512),[[C,c.value]]),t[1]||(t[1]=r("button",{type:"submit",class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-3 rounded-full font-semibold shadow hover:scale-105 transition-all duration-200"}," Prévisions ",-1)),r("button",{type:"button",onClick:k,class:"bg-white/80 dark:bg-gray-700/80 text-blue-700 dark:text-blue-300 px-4 py-3 rounded-full shadow hover:bg-blue-100 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 transition-all duration-200",title:"Prévisions de ma position"}," 📍 ")],32)]),o.value?(u(),d("div",L,a(o.value),1)):f("",!0),l.value?(u(),d("div",U,[(u(!0),d(M,null,D(l.value,(e,n)=>(u(),d("div",{key:n,class:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-2xl p-4 shadow-lg border border-white/40 dark:border-gray-700/40"},[r("div",I,[r("h3",R,a(e.date),1),r("img",{src:e.icon,alt:e.description,class:"w-12 h-12 mb-2"},null,8,S),r("p",z,a(e.description),1),r("div",A,a(e.temp)+"°C",1),r("div",B," Min: "+a(e.tempMin)+"°C | Max: "+a(e.tempMax)+"°C ",1),r("div",K,[r("div",null,"Humidité: "+a(e.humidity)+"%",1),r("div",null,"Vent: "+a(e.wind)+" km/h",1)])])]))),128))])):o.value?f("",!0):(u(),d("div",N,t[2]||(t[2]=[r("p",{class:"text-xl"},"Entrez une ville pour voir les prévisions météo",-1)])))])]))}};export{W as default};
